# Exporting functionality for others {#sec-exports}

```{r, echo = FALSE}
source("common.R")
status("restructuring")
```

## Exports {#exports}

For a function to be usable outside of your package, you must **export** it.
When you create a new package with `usethis::create_package()`, nothing is exported at first.
You can still experiment interactively with `load_all()` (since that loads all functions, not just those that are exported).
But if you install and reload the package, you'll notice that no functions are available.

To export an object, put `@export` in its roxygen block.
For example:

```{r}
#' @export
foo <- function(x, y, z) {
  ...
}
```

This will then generate `export()`, `exportMethods()`, `exportClass()` or `S3method()` depending on the type of the object.

You export functions that you want other people to use.
Exported functions must be documented, and you must be cautious when changing their interface --- other people are using them!
Generally, it's better to export too little than too much.
It's easy to export things that you didn't before; it's hard to stop exporting a function because it might break existing code.
Always err on the side of caution, and simplicity.
It's easier to give people more functionality than it is to take away stuff they're used to.

I believe that packages that have a wide audience should strive to do one thing and do it well.
All functions in a package should be related to a single problem (or a set of closely related problems).
Any functions not related to that purpose should not be exported.
For example, most of my packages have a `utils.R` file that contains many small functions that are useful for me, but aren't part of the core purpose of those packages.
I never export these functions.

```{r}
# Defaults for NULL values
`%||%` <- function(a, b) if (is.null(a)) b else a

# Remove NULLs from a list
compact <- function(x) {
  x[!vapply(x, is.null, logical(1))]
}
```

That said, if you're creating a package for yourself, it's far less important to be so disciplined.
Because you know what's in your package, it's fine to have a local "misc" package that contains a passel of functions that you find useful.
But I don't think you should release such a package.

The following sections describe what you should export if you're using S3, S4 or RC.

### Workflow {#namespace-workflow}

Generating the namespace with roxygen2 is just like generating function documentation with roxygen2.
You use roxygen2 blocks (starting with `#'`) and tags (starting with `@`).
The workflow is the same:

1.  Add roxygen comments to your `.R` files.

2.  Run `devtools::document()` (or press Ctrl/Cmd + Shift + D in RStudio) to convert roxygen comments to `.Rd` files.

3.  Look at `NAMESPACE` and run tests to check that the specification is correct.

4.  Rinse and repeat until the correct functions are exported.
